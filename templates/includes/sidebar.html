{% load static %}
<aside class="right-sidebar" aria-label="Primary navigation">
  <nav class="right-nav d-flex flex-column align-items-center m-5">
    
    <a href="/" class="nav-item" title="Home" aria-label="Home">
      <i class="fas fa-home fa-lg"></i>
    </a>
    <a href="/reports/" class="nav-item mt-3" title="Reports" aria-label="Reports">
      <i class="fas fa-clipboard-list fa-lg"></i>
    </a>

    <a href="/chatbot-faq/" class="nav-item mt-3 chatbot-faq" title="Chatbot FAQ" aria-label="Chatbot FAQ">
      <i class="fas fa-robot fa-lg" aria-hidden="true"></i>
    </a>

    <div class="nav-spacer"></div>

    {% if user.is_authenticated %}
    
    <div class="btn-group dropup dropstart mb-3">
      
    <a href="#" 
    class="nav-item"
    data-bs-toggle="dropdown" 
    aria-expanded="false" 
    title="Profile" 
        style="cursor: pointer; text-decoration: none;">
        {% if user.socialaccount_set.count %}
            <img
            src="{{ user.socialaccount_set.all.0.get_avatar_url }}"
            alt="Profile"
            class="profile-avatar"
            style="user-select: none;" draggable="false"
            />

        {% elif user.profile.avatar_animal %}
            <img
            src="{% static 'account/img/' %}{{ user.profile.avatar_animal }}.svg"
            alt="Avatar"
            class="profile-avatar"
            style="background-color: #f0f0f0; padding: 2px; user-select: none;" draggable="false"
            />

        {% else %}
            <div class="d-flex justify-content-center align-items-center" style="width: 32px; height: 32px; background: #333; border-radius: 50%;">
                <i class="fas fa-user fa-sm text-white"></i>
            </div>
        {% endif %}
    </a>
      <ul class="bg-dark dropdown-menu shadow p-3 border-0" style="min-width: 240px; border-radius: 12px; margin-right: 15px;">
        
        <li class="text-center mb-2">
            <h6 class="fw-bold mb-0 text-white">Hello, {{ user.username|truncatechars:12 }}</h6>
            <small class="text-white" style="font-size: 0.8rem;">
                {% if user.profile.is_guest %} Guest Account {% else %} Member {% endif %}
            </small>
        </li>

        <li><hr class="dropdown-divider"></li>

        <li class="mb-2">
            <a href="/profile/" class="btn btn-light w-100 text-start btn-sm d-flex align-items-center">
                <i class="fas fa-user me-2 text-primary"></i> My Profile
            </a>
        </li>

        <li>
            <form method="post" action="{% url 'account_logout' %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger w-100 text-start btn-sm d-flex align-items-center">
                    <i class="fas fa-sign-out-alt me-2"></i> Sign Out
                </button>
            </form>
        </li>
      </ul>
    </div>

    {% else %}
    <a href="/profile/" class="nav-item mb-3" title="Sign In" aria-label="Sign In">
      <i class="fas fa-user fa-lg"></i>
    </a>
    {% endif %}

  </nav>
</aside>